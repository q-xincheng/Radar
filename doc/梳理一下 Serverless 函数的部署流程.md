部署 Serverless 函数（以阿里云 FC 或 AWS Lambda 为例）的核心思想是：**“只管代码，不理服务器”**。你不需要配置操作系统或 Nginx，只需要将代码打包并定义触发规则。

以下是针对“行研雷达”智能体的部署流程梳理：

---

## 1. 部署架构概览

在云原生环境下，你的代码不再是持续运行的进程，而是被“事件”唤醒的短暂任务。

---

## 2. 详细部署步骤

### **第一步：环境准备与打包**

Serverless 环境通常只内置了基础运行库。由于你的智能体需要调用 LLM SDK（如 `openai` 或 `dashscope`）以及爬虫工具（如 `requests` 或 `BeautifulSoup`），你需要处理**依赖包**。

- **本地开发：** 在本地文件夹中编写 `index.py`。
    
- **安装依赖：** 在项目根目录执行 `pip install -t . -r requirements.txt`，将依赖直接下载到当前文件夹。
    
- **打包：** 将代码文件与依赖库一起压缩成一个 `.zip` 包。
    

### **第二步：创建云函数 (Function Configuration)**

在云平台控制台（或使用 Serverless Devs 工具）：

1. **选择运行环境：** 推荐 Python 3.9 或 3.10。
    
2. **上传代码：** 上传第一步准备好的 `.zip` 包。
    
3. **配置环境变量：** * 将 `LLM_API_KEY`、`OSS_ENDPOINT` 等敏感信息设为环境变量，不要硬编码在代码里。
    
4. **资源配额：** * **内存：** 建议 512MB 以上（处理 LLM 文本解析需要一定内存）。
    
    - **超时时间：** 建议设为 60s - 300s（网络爬取和 LLM 响应可能较慢）。
        

### **第三步：配置权限 (RAM/IAM Roles)**

这是新手最容易踩坑的地方。你的函数默认没有权限读写存储空间：

- **授权：** 为该函数分配一个角色（Role），并赋予 `AliyunOSSFullAccess`（或针对特定 Bucket 的权限）。
    
- **作用：** 确保代码执行 `storage.save_report()` 时不会报错。
    

### **第四步：设置定时触发器 (Triggers)**

为了实现题目要求的“24小时自动巡检”：

- **类型：** 选择“定时触发器 (Cron Trigger)”。
    
- **表达式：** `0 0 */6 * * *` （代表每 6 小时触发一次）。
    
- **输入：** 触发器可以携带配置参数（如行业关键词 `{"keyword": "半导体"}`），函数通过 `event` 参数接收。
    

---

## 3. 部署后的生命周期管理

|**阶段**|**状态说明**|
|---|---|
|**冷启动**|第一次触发时，云端会申请资源并解压代码，耗时较长（1-2秒）。|
|**执行中**|函数处理爬虫数据、对比旧报告、输出高亮结果。|
|**销毁/冻结**|执行完毕后，计算资源立即释放，你只为执行的那几十秒付费。|

---

## 4. 调试与监控建议

- **日志服务 (SLS/CloudWatch)：** 务必在代码中多写 `print()` 或 `logging.info()`。Serverless 无法远程登录，日志是你排查爬虫是否抓到数据的唯一手段。
    
- **版本控制：** 题目要求存储“报告版本历史”。除了在代码里逻辑实现，你也可以开启 OSS 的**版本控制功能**作为双重保险。